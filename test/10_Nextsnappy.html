<!DOCTYPE html><html lang="ja"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Fabric.js Snapping Example</title><script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.0/fabric.min.js"></script><style>canvas{border:1px solid #ccc}</style></head><body><canvas id="c" width="800" height="600"></canvas><script>const SnappyRect=fabric.util.createClass(fabric.Rect,{initialize:function(t){t||(t={}),this.callSuper("initialize",t),this.guides={}},_render:function(t){this.callSuper("_render",t),this._drawObjectGuides()},_drawObjectGuides:function(){const t=this.getScaledWidth(),e=this.getScaledHeight();this._drawGuide("top",this.top),this._drawGuide("left",this.left),this._drawGuide("centerX",this.left+t/2),this._drawGuide("centerY",this.top+e/2),this._drawGuide("right",this.left+t),this._drawGuide("bottom",this.top+e),this.setCoords()},_drawGuide:function(t,e){let i;const s={left:0,top:0,evented:!0,stroke:"rgb(178, 207, 255)",selectable:!1,opacity:1};i="top"===t||"bottom"===t?new fabric.Line([0,e,this.canvas.width,e],s):new fabric.Line([e,0,e,this.canvas.height],s),this.guides[t]instanceof fabric.Line&&(this.canvas.remove(this.guides[t]),delete this.guides[t]),this.guides[t]=i,this.canvas.add(i)}}),SnappyPolygon=fabric.util.createClass(fabric.Polygon,{initialize:function(t,e){e||(e={}),this.callSuper("initialize",t,e),this.guides={}},_render:function(t){this.callSuper("_render",t),this._drawObjectGuides()},_drawObjectGuides:function(){const t=this.getBoundingRect();this._drawGuide("top",t.top),this._drawGuide("left",t.left),this._drawGuide("centerX",t.left+t.width/2),this._drawGuide("centerY",t.top+t.height/2),this._drawGuide("right",t.left+t.width),this._drawGuide("bottom",t.top+t.height),this.setCoords()},_drawGuide:function(t,e){let i;const s={left:0,top:0,evented:!0,stroke:"rgb(178, 207, 255)",selectable:!1,opacity:1};i="top"===t||"bottom"===t?new fabric.Line([0,e,this.canvas.width,e],s):new fabric.Line([e,0,e,this.canvas.height],s),this.guides[t]instanceof fabric.Line&&(this.canvas.remove(this.guides[t]),delete this.guides[t]),this.guides[t]=i,this.canvas.add(i)}}),canvas=new fabric.Canvas("c"),rect1=new SnappyRect({width:100,height:100,fill:"red",left:100,top:100}),rect2=new SnappyRect({width:100,height:100,fill:"blue",left:300,top:100}),polygon=new SnappyPolygon([{x:50,y:0},{x:100,y:50},{x:50,y:100},{x:0,y:50}],{fill:"green",left:200,top:200});canvas.add(rect1,rect2,polygon),canvas.on("object:moving",(function(t){const e=t.target;canvas.getObjects().filter((t=>t!==e)).forEach((t=>{Math.abs(e.left-t.left)<10&&(e.left=t.left),Math.abs(e.top-t.top)<10&&(e.top=t.top)}))}))</script></body></html>