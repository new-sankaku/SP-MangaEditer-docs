<!DOCTYPE html><html lang="ja"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>改良版：ラメテクスチャ付きテキスト</title><script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.1/fabric.min.js"></script><style>body{display:flex;justify-content:center;align-items:center;min-height:100vh;margin:0;background-color:#f0f0f0;font-family:Arial,sans-serif}.container{text-align:center}.controls{margin-top:20px;display:grid;grid-template-columns:repeat(2,1fr);gap:10px}.control{display:flex;align-items:center;justify-content:flex-end}label{margin-right:10px}input[type=range]{width:150px}</style></head><body><div class="container"><canvas id="canvas" width="800" height="400"></canvas><div class="controls"><div class="control"><label for="text">テキスト:</label> <input type="text" id="text" value="ラメ効果"></div><div class="control"><label for="fontSize">フォントサイズ:</label> <input type="range" id="fontSize" min="20" max="200" value="100"> <span id="fontSizeValue">100</span></div><div class="control"><label for="textColor">テキスト色:</label> <input type="color" id="textColor" value="#FFFFFF"></div><div class="control"><label for="canvasBgColor">Canvas背景色:</label> <input type="color" id="canvasBgColor" value="#000000"></div><div class="control"><label for="textShadowColor">テキストシャドウ色:</label> <input type="color" id="textShadowColor" value="#000000"></div><div class="control"><label for="textShadowBlur">シャドウブラー:</label> <input type="range" id="textShadowBlur" min="0" max="50" value="10" step="1"> <span id="textShadowBlurValue">10</span></div><div class="control"><label for="textShadowOffsetX">シャドウオフセットX:</label> <input type="range" id="textShadowOffsetX" min="-50" max="50" value="10" step="1"> <span id="textShadowOffsetXValue">10</span></div><div class="control"><label for="textShadowOffsetY">シャドウオフセットY:</label> <input type="range" id="textShadowOffsetY" min="-50" max="50" value="10" step="1"> <span id="textShadowOffsetYValue">10</span></div><div class="control"><label for="particleSize">粒子サイズ:</label> <input type="range" id="particleSize" min="1" max="10" value="3" step="0.1"> <span id="particleSizeValue">3</span></div><div class="control"><label for="particleDensity">粒子密度:</label> <input type="range" id="particleDensity" min="0" max="10000" value="1000"> <span id="particleDensityValue">1000</span></div><div class="control"><label for="glitterColor">ラメの基本色:</label> <input type="color" id="glitterColor" value="#FFD700"></div><div class="control"><label for="colorVariation">ラメの色のバリエーション:</label> <input type="range" id="colorVariation" min="0" max="100" value="20"> <span id="colorVariationValue">20</span></div><div class="control"><label for="glitterBlur">ラメのブラー:</label> <input type="range" id="glitterBlur" min="0" max="10" value="0" step="0.1"> <span id="glitterBlurValue">0</span></div><div class="control"><label for="glitterShadowBlur">ラメのシャドウぼかし:</label> <input type="range" id="glitterShadowBlur" min="0" max="20" value="0" step="0.1"> <span id="glitterShadowBlurValue">0</span></div><div class="control"><label for="glitterShadowColor">ラメのシャドウ色:</label> <input type="color" id="glitterShadowColor" value="#FFA500"></div><div class="control"><label for="textOutlineColor">アウトライン色:</label> <input type="color" id="textOutlineColor" value="#000000"></div><div class="control"><label for="textOutlineWidth">アウトライン幅:</label> <input type="range" id="textOutlineWidth" min="0" max="10" value="1" step="0.1"> <span id="textOutlineWidthValue">1</span></div><div class="control"><label for="textBold">太字:</label> <input type="checkbox" id="textBold"></div></div></div><script>const canvas=new fabric.Canvas("canvas");function createGlitterTexture(){const e=document.createElement("canvas"),t=e.getContext("2d"),a=parseFloat(document.getElementById("particleSize").value),n=parseInt(document.getElementById("particleDensity").value),o=document.getElementById("glitterColor").value,l=parseInt(document.getElementById("colorVariation").value),r=parseFloat(document.getElementById("glitterBlur").value),d=parseFloat(document.getElementById("glitterShadowBlur").value),c=document.getElementById("glitterShadowColor").value;e.width=canvas.width,e.height=canvas.height,t.clearRect(0,0,e.width,e.height),t.shadowBlur=d,t.shadowColor=c;for(let r=0;r<n;r++){const n=Math.random()*e.width,r=Math.random()*e.height,d=varyColor(o,l);t.fillStyle=d,t.beginPath(),t.arc(n,r,a,0,2*Math.PI),t.fill()}return r>0&&(t.filter=`blur(${r}px)`,t.drawImage(e,0,0),t.filter="none"),e.toDataURL()}function varyColor(e,t){const a=hexToRgb(e),n=Math.max(0,Math.min(255,a.r+(Math.random()-.5)*t*2)),o=Math.max(0,Math.min(255,a.g+(Math.random()-.5)*t*2)),l=Math.max(0,Math.min(255,a.b+(Math.random()-.5)*t*2));return`rgb(${Math.round(n)}, ${Math.round(o)}, ${Math.round(l)})`}function hexToRgb(e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}function updateText(){const e=document.getElementById("text").value,t=parseInt(document.getElementById("fontSize").value),a=(document.getElementById("textColor").value,document.getElementById("textShadowColor").value),n=parseFloat(document.getElementById("textShadowBlur").value),o=parseFloat(document.getElementById("textShadowOffsetX").value),l=parseFloat(document.getElementById("textShadowOffsetY").value),r=document.getElementById("textOutlineColor").value,d=parseFloat(document.getElementById("textOutlineWidth").value),c=document.getElementById("textBold").checked,u=document.getElementById("canvasBgColor").value;canvas.setBackgroundColor(u,canvas.renderAll.bind(canvas)),canvas.clear();const i=createGlitterTexture();fabric.Image.fromURL(i,(function(u){const i=new fabric.Pattern({source:u._element,repeat:"repeat"}),m=new fabric.Text(e,{left:canvas.width/2,top:canvas.height/2,fontSize:t,fontFamily:"Arial",originX:"center",originY:"center",fill:i,stroke:r,strokeWidth:d,fontWeight:c?"bold":"normal",shadow:new fabric.Shadow({color:a,blur:n,offsetX:o,offsetY:l})});canvas.add(m),canvas.renderAll()}))}document.querySelectorAll("input").forEach((e=>{e.addEventListener("input",(function(e){"range"===this.type&&(document.getElementById(`${this.id}Value`).textContent=this.value),updateText()}))})),updateText()</script></body></html>