<!DOCTYPE html><html lang="ja"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>スピログラフと派生パターン - Canvas API</title><style>body{margin:0;display:flex;flex-direction:column;justify-content:center;align-items:center;height:100vh;background:#f0f0f0}#controls{margin-bottom:20px;display:flex;flex-wrap:wrap;justify-content:center}#controls>div{margin:0 10px}label{display:inline-block;width:150px}#patternType{margin-bottom:10px}</style></head><body><div id="controls"><div><label for="patternType">パターンタイプ:</label> <select id="patternType"><option value="classic">クラシックスピログラフ</option><option value="epicycloid">エピサイクロイド</option><option value="rose">ローズカーブ</option><option value="lissajous">リサージュ曲線</option></select></div><div id="paramControls"></div><div><button id="redraw">再描画</button></div></div><canvas id="canvas" width="800" height="800"></canvas><script>const canvas=document.getElementById("canvas"),ctx=canvas.getContext("2d"),redrawBtn=document.getElementById("redraw"),patternTypeSelect=document.getElementById("patternType"),paramControls=document.getElementById("paramControls");let currentParams={};const patterns={classic:{params:{R:{min:100,max:300,value:200,step:10,label:"外側の円の半径 (R)"},r:{min:10,max:150,value:80,step:5,label:"内側の円の半径 (r)"},d:{min:0,max:150,value:60,step:5,label:"ペンの位置 (d)"},rotations:{min:1,max:100,value:20,step:1,label:"回転数"}},draw:a=>{const{R:e,r:t,d:n,rotations:s}=a;ctx.beginPath();const l=(a,e)=>0===e?a:l(e,a%e),r=(e-t)/l(e-t,t),c=2*Math.PI*r*s,o=c/1e4;for(let a=0;a<=c;a+=o){const s=(e-t)*Math.cos(a)+n*Math.cos((e-t)/t*a),l=(e-t)*Math.sin(a)-n*Math.sin((e-t)/t*a);0===a?ctx.moveTo(s+canvas.width/2,l+canvas.height/2):ctx.lineTo(s+canvas.width/2,l+canvas.height/2)}ctx.stroke()}},epicycloid:{params:{R:{min:100,max:300,value:200,step:10,label:"固定円の半径 (R)"},r:{min:10,max:150,value:80,step:5,label:"動く円の半径 (r)"},rotations:{min:1,max:20,value:5,step:1,label:"回転数"}},draw:a=>{const{R:e,r:t,rotations:n}=a;ctx.beginPath();const s=2*Math.PI*n,l=s/1e3;for(let a=0;a<=s;a+=l){const n=(e+t)*Math.cos(a)-t*Math.cos((e+t)/t*a),s=(e+t)*Math.sin(a)-t*Math.sin((e+t)/t*a);0===a?ctx.moveTo(n+canvas.width/2,s+canvas.height/2):ctx.lineTo(n+canvas.width/2,s+canvas.height/2)}ctx.stroke()}},rose:{params:{a:{min:1,max:10,value:5,step:1,label:"a (ペタルの数に影響)"},k:{min:1,max:10,value:2,step:1,label:"k (形状に影響)"},size:{min:50,max:300,value:200,step:10,label:"サイズ"}},draw:a=>{const{a:e,k:t,size:n}=a;ctx.beginPath();const s=2*Math.PI*e,l=s/1e3;for(let a=0;a<=s;a+=l){const e=n*Math.cos(t*a),s=e*Math.cos(a),l=e*Math.sin(a);0===a?ctx.moveTo(s+canvas.width/2,l+canvas.height/2):ctx.lineTo(s+canvas.width/2,l+canvas.height/2)}ctx.stroke()}},lissajous:{params:{a:{min:1,max:10,value:3,step:1,label:"X周波数 (a)"},b:{min:1,max:10,value:2,step:1,label:"Y周波数 (b)"},delta:{min:0,max:360,value:90,step:15,label:"位相差 (δ)"},size:{min:50,max:300,value:200,step:10,label:"サイズ"}},draw:a=>{const{a:e,b:t,delta:n,size:s}=a;ctx.beginPath();const l=2*Math.PI,r=l/1e3;for(let a=0;a<=l;a+=r){const l=s*Math.sin(e*a),r=s*Math.sin(t*a+n*Math.PI/180);0===a?ctx.moveTo(l+canvas.width/2,r+canvas.height/2):ctx.lineTo(l+canvas.width/2,r+canvas.height/2)}ctx.stroke()}}};function createControls(a){paramControls.innerHTML="",Object.entries(patterns[a].params).forEach((([a,e])=>{const t=document.createElement("div");t.innerHTML=`\n                    <label for="${a}">${e.label}:</label>\n                    <input type="range" id="${a}" min="${e.min}" max="${e.max}" value="${e.value}" step="${e.step}">\n                    <span id="${a}Value">${e.value}</span>\n                `,paramControls.appendChild(t);const n=t.querySelector(`#${a}`),s=t.querySelector(`#${a}Value`);n.addEventListener("input",(()=>{currentParams[a]=parseInt(n.value),s.textContent=n.value,redraw()})),currentParams[a]=e.value}))}function redraw(){ctx.clearRect(0,0,canvas.width,canvas.height),ctx.strokeStyle=`hsl(${360*Math.random()}, 70%, 50%)`,ctx.lineWidth=2;const a=patternTypeSelect.value;patterns[a].draw(currentParams)}patternTypeSelect.addEventListener("change",(()=>{createControls(patternTypeSelect.value),redraw()})),redrawBtn.addEventListener("click",redraw),createControls(patternTypeSelect.value),redraw()</script></body></html>